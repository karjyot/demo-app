<!DOCTYPE html>
<html>
<head>
  <title>Safari Popup Block vs Workaround</title>
</head>
<body>
  <h2>ğŸ§ª Safari Popup Behavior Test</h2>

  <h3>âŒ Blocked Version (Safari will block this)</h3>
  <button id="blocked-btn">Open After API Call (Blocked)</button>

  <h3>âœ… Allowed Version (Safari-Compatible)</h3>
  <button id="allowed-btn">Open After API Call (Workaround)</button>
<a id="redirectLink" href="" target="_blank" style="display:none;">Go</a>
<button id="goBtn">Open Page</button>
  <script>
    // âŒ Blocked in Safari
    document.getElementById('blocked-btn').addEventListener('click', function () {
      fetch('https://jsonplaceholder.typicode.com/posts/1')
        .then(response => response.json())
        .then(data => {
          const link = document.getElementById("redirectLink");
    link.href = data.url;
    link.click(); 
          //window.open('https://www.example.com', '_blank'); // âŒ Safari blocks this
        });
    });

    // âœ… Allowed in Safari
    document.getElementById('allowed-btn').addEventListener('click', function () {
      const newWindow = window.open('', '_blank'); // ğŸ‘ˆ Open immediately on click
      newWindow.document.write('Please wait while we are redirecting.....')
      fetch('https://jsonplaceholder.typicode.com/posts/1')
        .then(response => response.json())
        .then(data => {
  
         setTimeout(() => {
     newWindow.location.href = 'https://www.example.com'; // ğŸ‘ˆ Set URL later
}, 10000);
               
        });
                  
        
    });
  </script>
</body>
</html>
