<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>iOS Popup Block Warning</title>
<style>
#warning {
display: none;
color: red;
font-weight: bold;
margin-top: 20px;
}
button {
padding: 10px 20px;
font-size: 16px;
}
</style>
</head>
<body>

<h2>Test Popup Block (iOS)</h2>
<button onclick="startProcess()">Start</button>
<div id="warning">⚠️ Popup was blocked! Please enable popups for this site on your iPhone or iPad.</div>

<script>
function isIOS() {
const ua = navigator.userAgent || navigator.vendor || window.opera;

// Matches iPhone, iPod, and old iPads
if (/iPhone|iPad|iPod/i.test(ua)) return true;

// Detect iPads that identify as Mac (iPadOS 13+)
if (/Macintosh/.test(ua) && 'ontouchend' in document) return true;

return false;
}


async function startProcess() {
// Simulate async call to break user gesture
    alert(isIOS())

await fetch("https://jsonplaceholder.typicode.com/posts/1");

// Try to open a new window
const newWindow = window.open("https://example.com", "_blank");

// Heuristic to detect if popup was blocked
const blocked = !newWindow || typeof newWindow.closed === "undefined";
console.log(blocked);
if (isIOS() && blocked) {
document.getElementById("warning").style.display = "block";
} else if (newWindow) {
try {
newWindow.focus(); // will fail if blocked
} catch (e) {
document.getElementById("warning").style.display = "block";
}
}
}
</script>

</body>
</html>
